<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Model, View and Projection Demo</title>

    <script src="/libs/tailwindcss-3.4.5.js"></script>
    <script src="/libs/gl-matrix/dist/gl-matrix-min.js"></script>
    <script src="/libs/regl.min.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <main>
        <section>
            <div x-data="InteractApp" class="container mx-auto space-y-4">
                <div>
                    <h1 class="text-4xl"><strong>Model, View and Projection Demo</strong></h1>
                    <p>Recriando resultados do notebook do professor Cláudio Esperança: <a
                            class="text-blue-600 underline"
                            href="https://observablehq.com/@esperanc/model-view-and-projection-demo"
                            target="_blank">https://observablehq.com/@esperanc/model-view-and-projection-demo</a></p>
                </div>
                
                <div>
                    <p>A simple WebGL demo for helping understand how to set up a viewing frustum.</p>

                    <canvas x-ref="canvas" id="canvas" width="400" height="400"></canvas>
                </div>

                <div>
                    <div class="flex">
                        <button 
                            x-on:click="selectedTab=0" 
                            class="px-4 py-2 rounded-t-lg hover:bg-gray-200"
                            x-bind:class="{ 'bg-gray-200 border-x border-t border-black': selectedTab === 0 }"
                        >
                            Projection
                        </button>
                        <button 
                            x-on:click="selectedTab=1" 
                            class="px-4 py-2 rounded-t-lg hover:bg-gray-200"
                            x-bind:class="{ 'bg-gray-200 border-x border-t border-black': selectedTab === 1 }"
                        >
                            Model
                        </button>
                        <button 
                            x-on:click="selectedTab=2" 
                            class="px-4 py-2 rounded-t-lg hover:bg-gray-200"
                            x-bind:class="{ 'bg-gray-200 border-x border-t border-black': selectedTab === 2 }"
                        >
                            View
                        </button>
                    </div>

                    <div x-show="selectedTab === 0" x-data="" class="border-y p-4 space-y-4">
                        <div class="flex gap-2">
                            <select name="projectionMode" id="projectionMode">
                                <option value="perspective" selected>Perspective</option>
                                <option value="ortho">Ortho</option>
                            </select>
                            <button>Reset</button>
                        </div>

                        <div class="flex gap-4">
                            <div>
                                <label for="fov">FOV</label>
                                <input 
                                    id="fov" 
                                    name="fov" 
                                    class="border" 
                                    type="number" 
                                    value="45"
                                    min="0"
                                    max="180"
                                    step="1"
                                >
                            </div>

                            <div>
                                <label for="aspect">Aspect</label>
                                <input 
                                    id="aspect" 
                                    name="aspect" 
                                    class="border" 
                                    type="number" 
                                    value="1"
                                    min="0"
                                    max="10"
                                    step="0.1"
                                >
                            </div>

                            <div>
                                <label for="near">Near</label>
                                <input 
                                    id="near" 
                                    name="near" 
                                    class="border" 
                                    type="number" 
                                    value="0.1"
                                    min="0"
                                    max="10"
                                    step="0.1"
                                >
                            </div>

                            <div>
                                <label for="far">Far</label>
                                <input 
                                    id="far" 
                                    name="far" 
                                    class="border" 
                                    type="number" 
                                    value="10"
                                    min="-5"
                                    max="10"
                                    step="0.1"
                                >
                            </div>
                        </div>
                    </div>

                    <div x-show="selectedTab === 1" x-data="MatrixModelTab" class="border-y p-4 space-y-4">    
                        <div class="flex gap-2">
                            <button x-on:click="OnAddTranslate" class="shadow px-4 py-2 hover:bg-gray-200">+Translate</button>
                            <button x-on:click="OnAddScale" class="shadow px-4 py-2 hover:bg-gray-200">+Scale</button>
                            <button x-on:click="OnAddRotate" class="shadow px-4 py-2 hover:bg-gray-200">+Rotate</button>
                            <button x-on:click="
                                orderedTransformations = []
                                UpdateMatrix()
                            " class="shadow px-4 py-2 hover:bg-gray-200">Reset</button>
                        </div>
    
                        <template x-for="(transformation, i) in orderedTransformations">
                            <div>
                                <template x-if="transformation.type === 'translation'">
                                    <div class="flex gap-4">
                                        <div>
                                            <label for="translate-x">Translate X</label>
                                            <input 
                                                id="translate-x" 
                                                name="translate-x" 
                                                class="border" 
                                                x-on:change="
                                                    transformation.data[0] = Number($event.target.value)
                                                    UpdateMatrix()
                                                "
                                                type="number" 
                                                value="0"
                                                min="-2"
                                                max="2"
                                                step="0.1"
                                            >
                                        </div>
            
                                        <div>
                                            <label for="translate-y">Translate Y</label>
                                            <input 
                                                id="translate-y" 
                                                name="translate-y" 
                                                class="border" 
                                                x-on:change="
                                                    transformation.data[1] = Number($event.target.value)
                                                    UpdateMatrix()
                                                "
                                                type="number" 
                                                value="0"
                                                min="-2"
                                                max="2"
                                                step="0.1"
                                            >
                                        </div>
            
                                        <div>
                                            <label for="translate-z">Translate Z</label>
                                            <input 
                                                id="translate-z" 
                                                name="translate-z" 
                                                class="border" 
                                                x-on:change="
                                                    transformation.data[2] = Number($event.target.value)
                                                    UpdateMatrix()
                                                "
                                                type="number" 
                                                value="0"
                                                min="-2"
                                                max="2"
                                                step="0.1"
                                            >
                                        </div>
                                    </div>
                                </template>
                                
                                <template x-if="transformation.type === 'scaling'">
                                    <div class="flex gap-4">
                                        <div>
                                            <label for="scale-x">Scale X</label>
                                            <input 
                                                id="scale-x" 
                                                name="scale-x" 
                                                class="border" 
                                                x-on:change="
                                                    transformation.data[0] = Number($event.target.value)
                                                    UpdateMatrix()
                                                "
                                                type="number" 
                                                value="1"
                                                min="-2"
                                                max="2"
                                                step="0.1"
                                            >
                                        </div>
            
                                        <div>
                                            <label for="scale-y">Scale Y</label>
                                            <input 
                                                id="scale-y" 
                                                name="scale-y" 
                                                class="border"
                                                x-on:change="
                                                    transformation.data[1] = Number($event.target.value)
                                                    UpdateMatrix()
                                                "
                                                type="number" 
                                                value="1"
                                                min="-2"
                                                max="2"
                                                step="0.1"
                                            >
                                        </div>
            
                                        <div>
                                            <label for="scale-z">Scale Z</label>
                                            <input 
                                                id="scale-z" 
                                                name="scale-z" 
                                                class="border"
                                                x-on:change="
                                                    transformation.data[2] = Number($event.target.value)
                                                    UpdateMatrix()
                                                "
                                                type="number" 
                                                value="1"
                                                min="-2"
                                                max="2"
                                                step="0.1"
                                            >
                                        </div>
                                    </div>
                                </template>
    
                                <template x-if="transformation.type === 'rotation'">
                                    <div class="flex gap-4">
                                        <div>
                                            <label for="rotate-x">Rotate X</label>
                                            <input 
                                                id="rotate-x" 
                                                name="rotate-x" 
                                                class="border" 
                                                x-on:change="
                                                    transformation.data[0] = Number($event.target.value)
                                                    UpdateMatrix()
                                                "
                                                type="number" 
                                                value="0"
                                                min="-180"
                                                max="180"
                                            >
                                        </div>
            
                                        <div>
                                            <label for="rotate-y">Rotate Y</label>
                                            <input 
                                                id="rotate-y" 
                                                name="rotate-y" 
                                                class="border"
                                                x-on:change="
                                                    transformation.data[1] = Number($event.target.value)
                                                    UpdateMatrix()
                                                "
                                                type="number" 
                                                value="0"
                                                min="-180"
                                                max="180"
                                            >
                                        </div>
            
                                        <div>
                                            <label for="rotate-z">Rotate Z</label>
                                            <input 
                                                id="rotate-z" 
                                                name="rotate-z" 
                                                class="border"
                                                x-on:change="
                                                    transformation.data[2] = Number($event.target.value)
                                                    UpdateMatrix()
                                                "
                                                type="number" 
                                                value="0"
                                                min="-180"
                                                max="180"
                                            >
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </template>
    
                        <div x-text="latex" id="latex-matrix"></div>
                    </div>
    
                    <div x-show="selectedTab === 2" x-data="" class="border-y p-4 space-y-4">    </div>
                </div>
            </div>
        </section>
    </main>

    <script src="index.js" type="module"></script>

    <!-- A library to help me manipulate the DOM -->
    <script defer src="/libs/alpinejs.min.js"></script>
</body>

</html>